package xiatian.octopus.expt

import java.io.ByteArrayInputStream
import java.text.SimpleDateFormat

import jdk.nashorn.api.scripting.ScriptObjectMirror
import org.jsoup.Jsoup
import scalaj.http.Http
import xiatian.octopus.util.HashUtil

import scala.collection.JavaConverters._
import scala.concurrent.Await
import scala.concurrent.duration.Duration
import scala.util.{Success, Try}


/**
  * 浙江档案信息的抽取，用于论文档案在线咨询的互动数据分析
  *
  */
object ZhejiangArchive {
  val df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss")

  def getScriptFromList(start: Int, end: Int): String = {
    val url = "http://www.zjda.gov.cn/jact/front/dataproxy_mailpublist.do"
    val response = Http(url).params(Seq(
      "startrecord" -> s"$start",
      "endrecord" -> s"$end",
      "perpage" -> s"${end - start + 1}",
      "groupSize" -> "1"
    )).postForm(Seq(
      "sysid" -> "6",
      "orderfield" -> "1"))
    response.asString.body
  }

  /**
    * 解析服务器端返回的脚本数据，提取出其中的有效信息, 服务器端解出的数据格式为：
    * totalRecord=15124.0;totalPage=796;dataStore = ["<tr>	<td
    * align='center'... ];
    *
    * 返回该列表页的script脚本中包含的“已经处理”过的文章链接及其浏览数量
    *
    * @param script
    */
  def articleUrlsInScript(script: String): Seq[(String, Int)] = {
    import javax.script.ScriptEngineManager
    val engine = new ScriptEngineManager().getEngineByName("JavaScript")

    //执行JS脚本
    engine.eval(script)

    //获取脚本中的dataStore变量
    val array = engine.get("dataStore").asInstanceOf[ScriptObjectMirror]

    val items = array.asScala.toList.map {
      x =>
        //println(x._2)
        x._2.asInstanceOf[String]
    }

    items.map {
      content =>
        val html = s"<html><body><table>$content</table></body></html>"
        val pageUrl = "http://www.zjda.gov.cn/jact/front/dataproxy_mailpublist.do"
        val doc = Jsoup.parse(html, pageUrl)

        val articleUrl = doc.select("a")
          .asScala.map(_.attr("abs:href"))
          .filter(_.contains("mailpubdetail.do")).head

        val status = if (html.contains("""处理完毕</td>""")) "处理完毕" else "等待受理"
        val viewCount = doc.select("td").last.text.trim

        (articleUrl, status, viewCount)
    }.filter(_._2 == "处理完毕").map {
      case (articleUrl, _, viewCount) =>
        (articleUrl, if (viewCount.isEmpty) 0 else viewCount.toInt)
    }
  }


  def parseArticle(articleUrl: String,
                   viewCount: Int,
                   category: String = "专家咨询"): Boolean = Try {
    val response = xiatian.octopus.util.Http.get(articleUrl,
      "http://www.zjda.gov.cn/jact/front/mailpublist.do?sysid=6")

    val html = response.getHtmlSource()
    if (html.startsWith("<script") &&
      html.contains("maildetail_error") && html.size < 100) {
      println(s"skip $articleUrl ...")
      false
    } else {
      val doc = Jsoup.parse(new ByteArrayInputStream(response.getContent),
        response.getEncoding, articleUrl)

      val tds = doc.select("div.jact_box div.jact_box_font >  table > tbody >  tr >  td").asScala
      val code = tds(5).text.trim
      val title = tds(1).text.trim
      val person = ""
      val askTime = tds(7).text.trim
      val askContent = tds(3).text.trim
      val status = tds(9).text.trim

      val replyTime = tds(15).text.trim + ":00"
      val replyContent = tds(11).text.trim
      val replier = tds(13).text.trim
      val urlMd5 = HashUtil.md5(articleUrl)

      val format = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss")

      val consult = ArchiveConsult(code, title, person,
        new java.sql.Timestamp(format.parse(askTime).getTime),
        askContent, status,
        new java.sql.Timestamp(format.parse(replyTime).getTime),
        replier,
        replyContent,
        articleUrl,
        urlMd5,
        viewCount,
        category,
        "Zhejiang"
      )

      Await.result(ArchiveConsultDb.save(consult), Duration.Inf)
      true
    }
  } match {
    case Success(result) =>
      result
    case scala.util.Failure(e) =>
      println(s"$articleUrl")
      e.printStackTrace()
      false
  }

  def startParse() = {
    var skipped = 0
    (1 to 152) foreach {
      p =>
        println(s"process page $p ...")
        val start = (p - 1) * 100 + 1
        val end = p * 100
        val script = getScriptFromList(start, end)
        articleUrlsInScript(script).zipWithIndex.foreach {
          case ((url, count), idx) =>
            if (!parseArticle(url, count)) skipped += 1
        }
    }

    println(s"skipped count: $skipped")
  }

  def main(args: Array[String]): Unit = {
    //    val script =
    //      """totalRecord=15124.0;totalPage=796;dataStore = ["<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200993'>ZJDY20190200993</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15244&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>咨询跨年立卷</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-28</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd'>100</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200992'>ZJDY20190200992</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15243&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>副高评审现任职务问题（续问）</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-28</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>99</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200991'>ZJDY20190200991</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15242&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>请问副高评审时间</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-28</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>160</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200990'>ZJDY20190200990</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15241&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案职称考试咨询</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-27</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>222</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200989'>ZJDY20190200989</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15240&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>归档章到底敲在哪页的（续问）</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-27</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd'>122</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200988'>ZJDY20190200988</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15239&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>物资与设备仪器的区别</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-27</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>92</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200987'>ZJDY20190200987</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15237&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>评审事宜</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-27</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>114</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200986'>ZJDY20190200986</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15236&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>中级转评</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-27</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>111</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200985'>ZJDY20190200985</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15235&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>关于副高评审的继续教育学时</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-27</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>100</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200984'>ZJDY20190200984</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15234&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>请问现在有立卷类目的说法吗？</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-26</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>80</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200983'>ZJDY20190200983</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15233&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案专业为什么没有执业资格考试？</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-26</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=120&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>郑金月</a></td>	<td align='center' width='85' class='tr_main_value_odd'>41</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200982'>ZJDY20190200982</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15232&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>咨询档案整理</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-26</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>92</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200981'>ZJDY20190200981</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15231&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案职称考试用书中的问题</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-25</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>103</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200980'>ZJDY20190200980</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15230&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>全宗卷材料固定</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-25</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=127&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>封小平</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>14</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200979'>ZJDY20190200979</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15229&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>乡村记忆工程相关内容咨询</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-24</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=122&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>何力迈</a></td>	<td align='center' width='85' class='tr_main_value_odd'>21</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200978'>ZJDY20190200978</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15228&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>企业投资项目档号编制问题</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-24</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>24</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200977'>ZJDY20190200977</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15227&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>已经获得其他专业的中级职称是否可以不用考试直接平转到档案专业</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-24</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>92</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200976'>ZJDY20190200976</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15226&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>归档章到底敲在哪页的？</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-22</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>122</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200975'>ZJDY20190200975</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15225&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案中级书中的疑问</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-22</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>60</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200974'>ZJDY20190200974</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15224&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>中级资格证书 继续教育学时要求</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-22</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>120</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200973'>ZJDY20190200973</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15223&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案培训咨询</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-22</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=120&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>郑金月</a></td>	<td align='center' width='85' class='tr_main_value_odd'>111</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200972'>ZJDY20190200972</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15222&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>关于副高评审时间问题</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-22</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=119&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>胡元潮</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>113</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200971'>ZJDY20190200971</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15221&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案初级职称考试</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-22</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=120&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>郑金月</a></td>	<td align='center' width='85' class='tr_main_value_odd'>88</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200970'>ZJDY20190200970</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15220&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>能否先整理归档排架后面月份的档案？</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-22</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>79</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200969'>ZJDY20190200969</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15219&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>咨询档案专项验收问题</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-21</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd'>77</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200968'>ZJDY20190200968</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15218&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>咨询法律文书题名著录方法</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-21</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=123&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>宋华</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>18</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200967'>ZJDY20190200967</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15217&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>咨询文书档案整理相关问题</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-21</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd'>18</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200966'>ZJDY20190200966</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15216&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案初级职称考试</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-21</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>5</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200965'>ZJDY20190200965</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15215&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>能否参加今年档案中级职称考试</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-20</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>132</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200964'>ZJDY20190200964</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15214&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>停建缓建</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-20</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>67</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200963'>ZJDY20190200963</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15213&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案管理上岗证</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-19</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>42</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200962'>ZJDY20190200962</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15212&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>工程档案管理培训</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-19</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>77</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200961'>ZJDY20190200961</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15211&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案中级职称考试用书</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-19</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=132&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>周峰林</a></td>	<td align='center' width='85' class='tr_main_value_odd'>17</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200960'>ZJDY20190200960</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15210&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>中级职称考试</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-18</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>186</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200959'>ZJDY20190200959</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15208&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>关于副高评审现任职务问题</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-17</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd'>153</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200958'>ZJDY20190200958</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15207&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案中级职称</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-16</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>145</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200957'>ZJDY20190200957</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15206&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案分类问题</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-15</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd'>132</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200956'>ZJDY20190200956</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15205&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>继续教育</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-15</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>135</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200955'>ZJDY20190200955</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15204&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>继续教育学时</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-15</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd'>124</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200954'>ZJDY20190200954</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15203&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>继续教育学时</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-14</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>113</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200953'>ZJDY20190200953</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15202&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>关于副高评审时间问题</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-14</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=120&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>郑金月</a></td>	<td align='center' width='85' class='tr_main_value_odd'>108</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200952'>ZJDY20190200952</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15201&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>发文文号</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-13</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>97</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200951'>ZJDY20190200951</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15200&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>真实性与可靠性的区别</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-12</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=123&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>宋华</a></td>	<td align='center' width='85' class='tr_main_value_odd'>182</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190200950'>ZJDY20190200950</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15199&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案库房验收</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-02-12</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=127&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>封小平</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>94</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190200949'>ZJDY20190200949</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15198&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>论文</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-11</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd'>132</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190100948'>ZJDY20190100948</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15197&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>页码问题</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-01-31</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>326</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190100947'>ZJDY20190100947</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15196&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>有关人事任免、表彰文件题名过长的相关问题</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-01-30</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=125&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>赵真</a></td>	<td align='center' width='85' class='tr_main_value_odd'>361</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190100946'>ZJDY20190100946</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15195&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>中级考试</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-01-30</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>258</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190100945'>ZJDY20190100945</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15194&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>照片和底片在系统上怎么挂接</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-01-30</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=123&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>宋华</a></td>	<td align='center' width='85' class='tr_main_value_odd'>307</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190100944'>ZJDY20190100944</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15193&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>招标文件及协议</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-01-29</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>271</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190100943'>ZJDY20190100943</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15192&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>考核材料是否要原件</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-01-29</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd'>147</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190100942'>ZJDY20190100942</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15191&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>卷内目录中的责任者填写</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-01-29</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>351</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190100941'>ZJDY20190100941</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15190&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档号章与归档章的区别</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-01-29</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=129&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>夏振华</a></td>	<td align='center' width='85' class='tr_main_value_odd'>284</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190100940'>ZJDY20190100940</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15189&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>企业人事档案和职工管理档案整理的标准</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-01-29</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=119&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>胡元潮</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>235</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190100939'>ZJDY20190100939</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15188&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>民营企业清算资料保管</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-01-28</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=119&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>胡元潮</a></td>	<td align='center' width='85' class='tr_main_value_odd'>198</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' style='background:#f3f3f3;' title='ZJDY20190100938'>ZJDY20190100938</td>	<td align='left' width='200' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpubdetail.do?transactId=15186&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>档案职称的书还改吗？</a></td>    <td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'>2019-01-28</td> 	<td align='center' width='110' class='tr_main_value_odd' style='background:#f3f3f3;'><a href='mailpublist.do?groupid=121&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>吴新宇</a></td>	<td align='center' width='85' class='tr_main_value_odd' style='background:#f3f3f3;'>155</td>  </tr>","<tr>	<td align='center' width='130' class='tr_main_value_odd' title='ZJDY20190100937'>ZJDY20190100937</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15185&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>对档案资料重复的理解</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-01-28</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=119&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>胡元潮</a></td>	<td align='center' width='85' class='tr_main_value_odd'>101</td>  </tr>"];
    //      """.stripMargin
    //    val pageUrl = "http://www.zjda.gov.cn/jact/front/mailpublist.do?sysid=6"
    //
    //    val articleUrls = articleUrlsInScript(script, pageUrl)
    //    articleUrls.zipWithIndex.foreach {
    //      case (url, idx) =>
    //        println(s"$idx \t $url")
    //    }
    //    println(s"Total: ${articleUrls.size}")

    //    val script = getScriptFromList(101, 200)
    //    println(script)
    //    articleUrlsInScript(script).zipWithIndex.foreach {
    //      case ((url, count), idx) =>
    //        println(s"$idx \t $count\t $url")
    //    }

//    parseArticle("http://www.zjda.gov.cn/jact/front/mailpubdetail" +
//      ".do?transactId=15211&sysid=6", 0)
    //
    //    val content =
    //      """<tr>	<td align='center' width='130' class='tr_main_value_odd'
    //        |title='ZJDY20190200979'>ZJDY20190200979</td>	<td align='left' width='200' class='tr_main_value_odd'><a href='mailpubdetail.do?transactId=15229&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>乡村记忆工程相关内容咨询</a></td>    <td align='center' width='85' class='tr_main_value_odd'>处理完毕</td>    	<td align='center' width='110' class='tr_main_value_odd'>2019-02-24</td> 	<td align='center' width='110' class='tr_main_value_odd'><a href='mailpublist.do?groupid=122&sysid=6' title='点击标题查看详细信息' target='_blank' class='tr_main_value_odd'>何力迈</a></td>	<td align='center' width='85' class='tr_main_value_odd'>21</td>  </tr>""".stripMargin
    //    val html = s"<html><body><table>$html</table></body></html>"
    //
    //    val doc = Jsoup.parse(html, "http://www.zjda.gov.cn/jact/front/list.do")
    //
    //    val articleUrl = doc.select("a")
    //      .asScala.map(_.attr("abs:href"))
    //      .filter(_.contains("mailpubdetail.do")).head
    //
    //    val viewCount = doc.select("td").asScala.last.text()
    //
    //
    //    val status = if (html.contains("""处理完毕</td>""")) "处理完毕" else "等待受理"
    //
    //    println(articleUrl)
    //    println(viewCount)
  }
}
